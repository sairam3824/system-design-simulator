module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},50227,(e,t,r)=>{t.exports=e.x("node:path",()=>require("node:path"))},57764,(e,t,r)=>{t.exports=e.x("node:url",()=>require("node:url"))},91335,(e,t,r)=>{t.exports=e.x("@prisma/client-a42149e401336614/runtime/client",()=>require("@prisma/client-a42149e401336614/runtime/client"))},81074,e=>e.a(async(t,r)=>{try{let t=await e.y("@libsql/client-1fcf21e78c4be154");e.n(t),r()}catch(e){r(e)}},!0),52022,e=>{"use strict";var t=e.i(74227);async function r(e){if(!(0,t.isRedisAvailable)())return null;try{let r=(0,t.getRedisClient)();if(!r)return null;return await r.get(e)}catch(e){return console.error("Cache get error:",e),null}}async function a(e,r,n=t.CACHE_TTL.USER_ANALYTICS){if(!(0,t.isRedisAvailable)())return!1;try{let a=(0,t.getRedisClient)();if(!a)return!1;return await a.set(e,JSON.stringify(r),{ex:n}),!0}catch(e){return console.error("Cache set error:",e),!1}}async function n(e){if(!(0,t.isRedisAvailable)())return!1;try{let r=(0,t.getRedisClient)();if(!r)return!1;return await r.del(e),!0}catch(e){return console.error("Cache delete error:",e),!1}}async function i(e){if(!(0,t.isRedisAvailable)())return!1;try{let r=(0,t.getRedisClient)();if(!r)return!1;let a=0;do{let[t,n]=await r.scan(a,{match:e,count:100});a=parseInt(t,10),n.length>0&&await r.del(...n)}while(0!==a)return!0}catch(e){return console.error("Cache delete pattern error:",e),!1}}async function s(e,n,i=t.CACHE_TTL.USER_ANALYTICS){let l=await r(e);if(null!==l){if("string"==typeof l)try{return JSON.parse(l)}catch{}return l}let o=await n();return await a(e,o,i),o}async function l(e){await i(`analytics:user:${e}*`)}async function o(){await i("leaderboard:*")}e.s(["cacheDelete",()=>n,"cacheDeletePattern",()=>i,"cacheGet",()=>r,"cacheSet",()=>a,"getOrFetch",()=>s,"invalidateLeaderboard",()=>o,"invalidateUserAnalytics",()=>l])},5134,e=>e.a(async(t,r)=>{try{var a=e.i(78968),n=e.i(52022),i=e.i(74227),s=t([a]);async function l(e,t,r=50){let s=`${i.CACHE_KEYS.LEADERBOARD}${e.timeFrame}:${e.topic||"all"}:${e.difficulty||"all"}`,o=async()=>{let n,i=function(e){let t=new Date;switch(e){case"week":return new Date(t.getTime()-6048e5);case"month":return new Date(t.getTime()-2592e6);case"all-time":return null}}(e.timeFrame),s={status:"completed"};i&&(s.endedAt={gte:i}),e.topic&&(s.topic=e.topic),e.difficulty&&"all"!==e.difficulty&&(s.difficulty=e.difficulty);let l=(await a.prisma.user.findMany({where:{interviews:{some:s}},select:{id:!0,name:!0,interviews:{where:s,select:{score:{select:{overallScore:!0,passStatus:!0}},endedAt:!0},orderBy:{endedAt:"desc"}}}})).map(e=>{let t,r=e.interviews.filter(e=>e.score).map(e=>e.score.overallScore);if(0===r.length)return null;let a=r.reduce((e,t)=>e+t,0)/r.length,n=e.interviews.filter(e=>e.score?.passStatus).length/r.length*100,i=function(e){if(e.length<2)return"stable";let t=Math.floor(e.length/2),r=e.slice(0,t),a=e.slice(t),n=r.reduce((e,t)=>e+t,0)/r.length,i=a.reduce((e,t)=>e+t,0)/a.length-n;return i>.2?"up":i<-.2?"down":"stable"}(r);return{userId:e.id,displayName:e.name||(t=e.id.slice(-4).toUpperCase(),`User #${t}`),avgOverallScore:Math.round(100*a)/100,completedInterviews:r.length,passRate:Math.round(n),trend:i}}).filter(e=>null!==e);l.sort((e,t)=>t.avgOverallScore!==e.avgOverallScore?t.avgOverallScore-e.avgOverallScore:t.completedInterviews-e.completedInterviews);let o=1,c=-1,d=l.slice(0,r).map((e,r)=>(e.avgOverallScore!==c&&(o=r+1,c=e.avgOverallScore),{rank:o,userId:e.userId,displayName:e.displayName,avgOverallScore:e.avgOverallScore,completedInterviews:e.completedInterviews,passRate:e.passRate,trend:e.trend,isCurrentUser:e.userId===t}));if(t){let e=l.findIndex(e=>e.userId===t);-1!==e&&(n=e+1)}return{entries:d,totalUsers:l.length,currentUserRank:n,filters:e}};return(0,n.getOrFetch)(s,o,i.CACHE_TTL.LEADERBOARD)}async function o(){return(await a.prisma.interview.findMany({where:{status:"completed"},select:{topic:!0},distinct:["topic"]})).map(e=>e.topic)}[a]=s.then?(await s)():s,e.s(["getLeaderboard",()=>l,"getLeaderboardTopics",()=>o]),r()}catch(e){r(e)}},!1),92723,e=>e.a(async(t,r)=>{try{var a=e.i(4575),n=e.i(63987),i=e.i(5134),s=t([n,i]);async function l(e){try{let t=await (0,n.auth)(),r=t?.user?.id,{searchParams:s}=new URL(e.url),l=s.get("timeFrame")||"all-time",o=s.get("topic")||void 0,c=s.get("difficulty")||"all",d=Math.min(parseInt(s.get("limit")||"50",10),100);if(!["week","month","all-time"].includes(l))return a.NextResponse.json({error:"Invalid timeFrame. Use: week, month, or all-time"},{status:400});if(!["easy","medium","hard","all"].includes(c))return a.NextResponse.json({error:"Invalid difficulty. Use: easy, medium, hard, or all"},{status:400});let u=await (0,i.getLeaderboard)({timeFrame:l,topic:o,difficulty:c},r,d),p=await (0,i.getLeaderboardTopics)();return a.NextResponse.json({...u,availableTopics:p})}catch(e){return console.error("Leaderboard API error:",e),a.NextResponse.json({error:"Failed to fetch leaderboard"},{status:500})}}[n,i]=s.then?(await s)():s,e.s(["GET",()=>l]),r()}catch(e){r(e)}},!1),43927,e=>e.a(async(t,r)=>{try{var a=e.i(98496),n=e.i(21818),i=e.i(78262),s=e.i(75769),l=e.i(93054),o=e.i(71202),c=e.i(72708),d=e.i(79667),u=e.i(96273),p=e.i(71884),h=e.i(61992),m=e.i(4474),f=e.i(10540),v=e.i(6262),g=e.i(86862),x=e.i(93695);e.i(17296);var y=e.i(74035),w=e.i(92723),R=t([w]);[w]=R.then?(await R)():R;let b=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/leaderboard/route",pathname:"/api/leaderboard",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/Documents/Git/system-design/system-design-simulator/src/app/api/leaderboard/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:_,workUnitAsyncStorage:A,serverHooks:S}=b;function C(){return(0,i.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:A})}async function E(e,t,r){b.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/leaderboard/route";a=a.replace(/\/index$/,"")||"/";let i=await b.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:w,params:R,nextConfig:C,parsedUrl:E,isDraftMode:_,prerenderManifest:A,routerServerContext:S,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,resolvedPathname:N,clientReferenceManifest:I,serverActionsManifest:q}=i,j=(0,c.normalizeAppPath)(a),k=!!(A.dynamicRoutes[j]||A.routes[N]),P=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,E,!1):t.end("This page could not be found"),null);if(k&&!_){let e=!!A.routes[N],t=A.dynamicRoutes[j];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await P();throw new x.NoFallbackError}}let U=null;!k||b.isDev||_||(U=N,U="/index"===U?"/":U);let D=!0===b.isDev||!k,H=k&&!D;q&&I&&(0,o.setManifestsSingleton)({page:a,clientReferenceManifest:I,serverActionsManifest:q});let L=e.method||"GET",M=(0,l.getTracer)(),F=M.getActiveScopeSpan(),$={params:R,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>b.onRequestError(e,t,a,n,S)},sharedContext:{buildId:w}},K=new d.NodeNextRequest(e),B=new d.NodeNextResponse(t),G=u.NextRequestAdapter.fromNodeNextRequest(K,(0,u.signalFromNodeResponse)(t));try{let i=async e=>b.handle(G,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=M.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${L} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${a}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),c=async s=>{var l,c;let d=async({previousCacheEntry:n})=>{try{if(!o&&T&&O&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await i(s);e.fetchMetrics=$.renderOpts.fetchMetrics;let l=$.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let c=$.renderOpts.collectedTags;if(!k)return await (0,m.sendResponse)(K,B,a,$.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(a.headers);c&&(t[g.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,n=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==n?void 0:n.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:T})},!1,S),t}},u=await b.handleResponse({req:e,nextConfig:C,cacheKey:U,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:o});if(!k)return null;if((null==u||null==(l=u.value)?void 0:l.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",T?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,f.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&k||p.delete(g.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,v.getCacheControlHeader)(u.cacheControl)),await (0,m.sendResponse)(K,B,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};F?await c(F):await M.withPropagatedContext(e.headers,()=>M.trace(p.BaseServerSpan.handleRequest,{spanName:`${L} ${a}`,kind:l.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},c))}catch(t){if(t instanceof x.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:j,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:T})},!1,S),k)throw t;return await (0,m.sendResponse)(K,B,new Response(null,{status:500})),null}}e.s(["handler",()=>E,"patchFetch",()=>C,"routeModule",()=>b,"serverHooks",()=>S,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>A]),r()}catch(e){r(e)}},!1),16005,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_node:buffer_00e2e67a._.js"].map(t=>e.l(t))).then(()=>t(51615)))},17059,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_@prisma_client_runtime_query_compiler_fast_bg_sqlite_mjs_6659bef3._.js"].map(t=>e.l(t))).then(()=>t(45217)))},46021,e=>{e.v(t=>Promise.all(["server/chunks/2e4a4_@prisma_client_runtime_query_compiler_fast_bg_sqlite_wasm-base64_mjs_dda4a92d._.js"].map(t=>e.l(t))).then(()=>t(82256)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__8e6d5b6f._.js.map